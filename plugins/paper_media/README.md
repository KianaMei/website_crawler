# çº¸åª’ç‹¬ç«‹æ’ä»¶æ¨¡å—

è¿™ä¸ªæ¨¡å—å°†åŸæ¥çš„å¤§å‹ `paper_news.py` æ’ä»¶æ‹†åˆ†ä¸ºç‹¬ç«‹çš„çº¸åª’æ’ä»¶ï¼Œæ¯ä¸ªæŠ¥çº¸éƒ½æœ‰è‡ªå·±çš„æ’ä»¶æ–‡ä»¶ï¼Œå¯ä»¥ç‹¬ç«‹è¿è¡Œã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
plugins/paper_media/
â”œâ”€â”€ __init__.py              # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ base.py                  # å…¬å…±åŸºç¡€ç±»å’Œå·¥å…·å‡½æ•°
â”œâ”€â”€ aggregator.py            # èšåˆæ’ä»¶ï¼ˆå…¼å®¹åŸæœ‰æ¥å£ï¼‰
â”œâ”€â”€ peopledaily.py           # äººæ°‘æ—¥æŠ¥ç‹¬ç«‹æ’ä»¶
â”œâ”€â”€ guangming.py             # å…‰æ˜æ—¥æŠ¥ç‹¬ç«‹æ’ä»¶  
â”œâ”€â”€ economic.py              # ç»æµæ—¥æŠ¥ç‹¬ç«‹æ’ä»¶
â”œâ”€â”€ xinhua.py                # æ–°åæ¯æ—¥ç”µè®¯ç‹¬ç«‹æ’ä»¶
â”œâ”€â”€ jjckb.py                 # ç»æµå‚è€ƒæŠ¥ç‹¬ç«‹æ’ä»¶
â”œâ”€â”€ qiushi.py                # æ±‚æ˜¯ç‹¬ç«‹æ’ä»¶
â”œâ”€â”€ test_plugins.py          # æ’ä»¶æµ‹è¯•è„šæœ¬
â””â”€â”€ README.md                # æœ¬æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. ä½¿ç”¨å•ä¸ªæ’ä»¶

```python
from plugins.paper_media.peopledaily import handler, Metadata
from plugins.paper_media.base import Args

# åˆ›å»ºå‚æ•°
args = Args({
    'max_items': 5,
    'date': '2024-09-25',  # å¯é€‰æŒ‡å®šæ—¥æœŸ
    'since_days': 3
})

# è°ƒç”¨æ’ä»¶
result = handler(args)

if result.status == 'OK':
    for news in result.news_list:
        print(f"æ ‡é¢˜: {news.title}")
        print(f"é“¾æ¥: {news.url}")
        print(f"æ‘˜è¦: {news.summary[:100]}...")
        print("-" * 50)
```

### 2. ä½¿ç”¨èšåˆæ’ä»¶

```python
from plugins.paper_media.aggregator import handler as agg_handler
from plugins.paper_media.base import Args

# è·å–æ‰€æœ‰çº¸åª’æ–°é—»
args = Args({
    'source': 'all',      # æˆ–æŒ‡å®š 'peopledaily', 'guangming' ç­‰
    'max_items': 10,
    'date': None          # è‡ªåŠ¨é€‰æ‹©æœ€è¿‘å¯ç”¨æ—¥æœŸ
})

result = agg_handler(args)
```

## ğŸ“‹ æ”¯æŒçš„æŠ¥çº¸

| æ’ä»¶æ–‡ä»¶ | æŠ¥çº¸åç§° | æè¿° |
|---------|---------|------|
| `peopledaily.py` | äººæ°‘æ—¥æŠ¥ | ä¸­å›½å…±äº§å…šä¸­å¤®å§”å‘˜ä¼šæœºå…³æŠ¥ |
| `guangming.py` | å…‰æ˜æ—¥æŠ¥ | ä¸­å¤®ä¸»è¦æ–°é—»åª’ä½“ |
| `economic.py` | ç»æµæ—¥æŠ¥ | å›½åŠ¡é™¢ä¸»ç®¡çš„ç»æµç±»æ—¥æŠ¥ |
| `xinhua.py` | æ–°åæ¯æ—¥ç”µè®¯ | æ–°åç¤¾ä¸»åŠçš„ç»¼åˆæ€§æ—¥æŠ¥ |
| `jjckb.py` | ç»æµå‚è€ƒæŠ¥ | æ–°åç¤¾ä¸»ç®¡çš„ç»æµç±»æŠ¥çº¸ |
| `qiushi.py` | æ±‚æ˜¯ | ä¸­å…±ä¸­å¤®ä¸»åŠçš„ç†è®ºæœŸåˆŠ |

## ğŸ”§ æ’ä»¶æ¶æ„

### åŸºç¡€ç»„ä»¶ (`base.py`)

- **Args**: æ¨¡æ‹Ÿè¿è¡Œæ—¶å‚æ•°ç±»
- **News**: æ–°é—»æ•°æ®æ¨¡å‹
- **PaperInput/PaperOutput**: æ ‡å‡†è¾“å…¥è¾“å‡ºæ¨¡å‹
- **fetch_url()**: æ™ºèƒ½ç¼–ç æ£€æµ‹çš„URLæŠ“å–
- **find_available_date()**: æ™ºèƒ½æ—¥æœŸæŸ¥æ‰¾
- **safe_handler()**: ç»Ÿä¸€é”™è¯¯å¤„ç†è£…é¥°å™¨

### æ’ä»¶è§„èŒƒ

æ¯ä¸ªæ’ä»¶éƒ½éµå¾ªç›¸åŒçš„ç»“æ„ï¼š

1. **Metadata**: æ’ä»¶å…ƒä¿¡æ¯
2. **get_page_list()**: è·å–ç‰ˆé¢åˆ—è¡¨
3. **get_title_list()**: è·å–æ–‡ç« é“¾æ¥åˆ—è¡¨
4. **parse_article()**: è§£ææ–‡ç« å†…å®¹
5. **handler()**: ä¸»å¤„ç†å‡½æ•°

### è¾“å…¥å‚æ•°

```python
{
    'max_items': int,        # æœ€å¤§æŠ“å–æ¡æ•° (1-50)
    'date': str,             # æŒ‡å®šæ—¥æœŸ 'YYYY-MM-DD' (å¯é€‰)
    'since_days': int        # æ—¶é—´çª—å£å¤©æ•° (1-365)
}
```

### è¾“å‡ºæ ¼å¼

```python
{
    'news_list': [           # æ–°é—»åˆ—è¡¨
        {
            'title': str,    # æ ‡é¢˜
            'url': str,      # é“¾æ¥
            'origin': str,   # æ¥æºæŠ¥çº¸
            'summary': str,  # æ‘˜è¦
            'publish_date': str  # å‘å¸ƒæ—¥æœŸ 'YYYY-MM-DD'
        }
    ],
    'status': str,           # 'OK' | 'EMPTY' | 'ERROR'
    'err_code': str,         # é”™è¯¯ç  (å¯é€‰)
    'err_info': str          # é”™è¯¯ä¿¡æ¯ (å¯é€‰)
}
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æ’ä»¶æµ‹è¯•

```bash
cd /path/to/project
python -m plugins.paper_media.test_plugins
```

### æµ‹è¯•å•ä¸ªæ’ä»¶

```python
python test_single_plugin.py
```

## âš¡ æ€§èƒ½ç‰¹ç‚¹

1. **ç‹¬ç«‹æ€§**: æ¯ä¸ªæ’ä»¶å¯å•ç‹¬ä½¿ç”¨ï¼Œäº’ä¸å½±å“
2. **å®¹é”™æ€§**: å•ä¸ªæ’ä»¶å¤±è´¥ä¸å½±å“å…¶ä»–æ’ä»¶
3. **æ™ºèƒ½ç¼–ç **: è‡ªåŠ¨æ£€æµ‹å’Œå¤„ç†å„ç§ç¼–ç 
4. **é‡è¯•æœºåˆ¶**: ç½‘ç»œè¯·æ±‚å¤±è´¥è‡ªåŠ¨é‡è¯•
5. **æ—¥æœŸæ™ºèƒ½**: è‡ªåŠ¨æŸ¥æ‰¾å¯ç”¨çš„æŠ¥çº¸æ—¥æœŸ

## ğŸ”„ å…¼å®¹æ€§

- âœ… å®Œå…¨å…¼å®¹åŸæœ‰ `paper_news.py` çš„åŠŸèƒ½
- âœ… æ”¯æŒç›¸åŒçš„è¾“å…¥è¾“å‡ºæ ¼å¼
- âœ… ä¿æŒç›¸åŒçš„é”™è¯¯å¤„ç†æ–¹å¼
- âœ… å¯ä»¥æ— ç¼æ›¿æ¢åŸæœ‰æ’ä»¶

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æŠ¥çº¸æ’ä»¶

1. å¤åˆ¶ç°æœ‰æ’ä»¶æ¨¡æ¿
2. å®ç°ä¸‰ä¸ªæ ¸å¿ƒå‡½æ•°ï¼š
   - `get_page_list(year, month, day)`
   - `get_title_list(year, month, day, page_url)`
   - `parse_article(html)`
3. ä½¿ç”¨ `@safe_handler()` è£…é¥°å™¨
4. æ›´æ–° `aggregator.py` ä¸­çš„ `SOURCE_MAP`

### è°ƒè¯•æŠ€å·§

- ä½¿ç”¨ `fetch_url()` ç»Ÿä¸€æŠ“å–ç½‘é¡µ
- åˆ©ç”¨ `find_available_date()` å¤„ç†æ—¥æœŸé—®é¢˜
- é€šè¿‡æ—¥å¿—è®°å½•è°ƒè¯•ä¿¡æ¯
- æµ‹è¯•æ—¶ä½¿ç”¨å°çš„ `max_items` å€¼

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **ç½‘ç«™ç»“æ„å˜åŒ–**: å„æŠ¥çº¸ç½‘ç«™å¯èƒ½æ›´æ–°ç»“æ„ï¼Œéœ€è¦åŠæ—¶é€‚é…
2. **è®¿é—®é¢‘ç‡**: é¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚ï¼Œå»ºè®®åŠ å…¥é€‚å½“å»¶è¿Ÿ
3. **ç¼–ç é—®é¢˜**: ä½¿ç”¨ `fetch_url()` å¯ä»¥è‡ªåŠ¨å¤„ç†å¤§éƒ¨åˆ†ç¼–ç é—®é¢˜
4. **é”™è¯¯å¤„ç†**: ä½¿ç”¨ `safe_handler` è£…é¥°å™¨ç¡®ä¿å¼‚å¸¸å®‰å…¨

## ğŸ“Š ä¸åŸç‰ˆå¯¹æ¯”

| ç‰¹æ€§ | åŸç‰ˆ paper_news.py | ç‹¬ç«‹æ’ä»¶æ¨¡å— |
|------|-------------------|-------------|
| ä»£ç ç»“æ„ | å•æ–‡ä»¶800+è¡Œ | å¤šæ–‡ä»¶æ¨¡å—åŒ– |
| å¯ç»´æŠ¤æ€§ | è¾ƒéš¾ç»´æŠ¤ | æ˜“äºç»´æŠ¤ |
| ç‹¬ç«‹æ€§ | ç´§è€¦åˆ | å®Œå…¨ç‹¬ç«‹ |
| æµ‹è¯•æ€§ | éš¾ä»¥å•ç‹¬æµ‹è¯• | å¯ç‹¬ç«‹æµ‹è¯• |
| æ‰©å±•æ€§ | éœ€ä¿®æ”¹ä¸»æ–‡ä»¶ | åªéœ€æ·»åŠ æ–°æ’ä»¶ |
| å®¹é”™æ€§ | ä¸€ä¸ªå¤±è´¥å…¨éƒ¨å¤±è´¥ | ç‹¬ç«‹å®¹é”™ |

é€šè¿‡è¿™ç§é‡æ„ï¼Œæˆ‘ä»¬è·å¾—äº†æ›´å¥½çš„ä»£ç ç»„ç»‡ã€æ›´å¼ºçš„å¯ç»´æŠ¤æ€§å’Œæ›´é«˜çš„å¼€å‘æ•ˆç‡ï¼